### Документация к программе  
**ГОСТ 19.101-77. Единая система программной документации. Виды программ и программных документов**  

---

#### **1. Введение**

Настоящий документ содержит описание программы на языке Python, реализующей веб-приложение с использованием фреймворка Dash. Программа предназначена для отображения списка заявок и информации об их согласовании. Документация составлена в соответствии с ГОСТ 19.

---

#### **2. Назначение программы**

Программа предназначена для:
- Отображения списка заявок из внешнего API.
- Просмотра данных о согласованиях выбранных заявок.
- Отображения информации о пользователях, участвующих в процессе согласования.

Программа может быть использована в системах управления заявками, где требуется удобный интерфейс для просмотра статусов согласования.

---

#### **3. Условия выполнения программы**

##### **3.1. Требования к техническим средствам**
- Процессор: 64-битный процессор с тактовой частотой не менее 1 ГГц.
- Оперативная память: не менее 4 ГБ.
- Свободное место на жестком диске: не менее 500 МБ.

##### **3.2. Требования к программным средствам**
- Операционная система: Windows 10/11, macOS, Linux.
- Интерпретатор Python версии 3.8 или выше.
- Установленные библиотеки: `dash`, `requests`.

##### **3.3. Требования к информационной поддержке**
- Доступность API по адресу `http://localhost:8000/workorder/`, `http://localhost:8000/user/`, `http://localhost:8000/approval/`.
- API должно возвращать данные в формате JSON.

---

#### **4. Выполнение программы**

##### **4.1. Запуск программы**
Для запуска программы необходимо выполнить следующие шаги:
1. Убедиться, что установлены все необходимые зависимости (`dash`, `requests`).
2. Запустить скрипт командой:
   ```bash
   python <имя_файла>.py
   ```
3. После запуска программа станет доступна по адресу `http://127.0.0.1:8050/`.

##### **4.2. Интерфейс программы**
Программа предоставляет веб-интерфейс, состоящий из следующих элементов:
- Заголовок "Заявки".
- Выпадающий список для выбора заявки.
- Блок для отображения данных о согласованиях выбранной заявки.

##### **4.3. Логика работы программы**
1. При загрузке страницы выполняется запрос к API для получения списка заявок.
2. Пользователь выбирает заявку из выпадающего списка.
3. Программа отправляет запросы к API для получения данных о согласованиях и пользователях.
4. На основе полученных данных формируется список согласований и отображается на странице.

---

#### **5. Структура программы**

##### **5.1. Используемые модули**
- `dash`: Фреймворк для создания веб-приложений.
- `dash.dependencies`: Модуль для работы с входными и выходными данными компонентов.
- `requests`: Библиотека для выполнения HTTP-запросов.

##### **5.2. Основные функции**
1. **`fetch_workorders()`**
   - Назначение: Получает список заявок из API.
   - Входные данные: Нет.
   - Выходные данные: Список словарей, содержащих `value` (ID заявки) и `label` (описание заявки).

2. **`fetch_users_and_approvals(workorderid)`**
   - Назначение: Получает данные о пользователях и согласованиях для указанной заявки.
   - Входные данные: `workorderid` — ID заявки.
   - Выходные данные: 
     - `user_dict` — словарь, где ключ — ID пользователя, значение — имя пользователя.
     - `approval_list` — список согласований.

3. **Callback `update_workorder_dropdown(_)`**
   - Назначение: Обновляет выпадающий список заявок при загрузке страницы.
   - Входные данные: `_` — заглушка для триггера.
   - Выходные данные: Список опций для выпадающего списка.

4. **Callback `display_approval(workorderid)`**
   - Назначение: Отображает данные о согласованиях выбранной заявки.
   - Входные данные: `workorderid` — ID выбранной заявки.
   - Выходные данные: HTML-элемент, содержащий список согласований или сообщение об отсутствии данных.

##### **5.3. Основные переменные**
- `app`: Экземпляр Dash-приложения.
- `workorder-dropdown`: ID выпадающего списка для выбора заявки.
- `approval-data`: ID блока для отображения данных о согласованиях.

---

#### **6. Сообщения оператору**

Программа выводит следующие сообщения:
- "В системе нет данных о пользователях." — если API не вернуло данные о пользователях.
- "В системе нет данных о согласовании." — если API не вернуло данные о согласованиях.
- "Нет данных о согласовании для данной заявки." — если согласования для выбранной заявки отсутствуют.

---

#### **7. Обработка ошибок**

Программа обрабатывает следующие ошибки:
1. Ошибки HTTP-запросов (например, недоступность API):
   - Выводится сообщение в консоль: `"Ошибка при получении данных о заявках: {e}"`.
   - Возвращается пустой список или словарь.
2. Отсутствие данных в ответах API:
   - Выводится соответствующее сообщение на странице.

---

#### **8. Заключение**

Программа успешно решает задачу отображения данных о заявках и их согласованиях. Она является гибкой и легко расширяемой за счет использования модульной архитектуры и современных технологий.